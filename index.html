<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Javascript Animation</title>

    <style>
        .container {
            margin: 50px auto;
            width: 60vw;
        }

        canvas {
            border: 2px solid red;
        }

        #btnToggle {
            border: none;
            background-color: red;
            border: 1px solid #ffd500;
            transition: 0.2s all linear;
            padding: 10px;
            border-radius: 5px;
            color: #fff;
            font-size: 24px;
            display: block;
            margin: 10px 0 0 120px;
            cursor: pointer;
        }

        #btnToggle:hover {
            background-color: #fff;
            color: orange;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Javascript <code>requestAnimationFrame()</code> API</h1>
        <canvas id="canvas1" width="400" height="400">
        </canvas>
        <div>
            <button id="btnToggle">Stop Animation</button>
        </div>
    </div>

    <script>

        //setup the animation constants and initial state
        var rectX = 0, rectY = 100, rectW = 40;
        var rectDir = 2;
        var canvas = context = null;
        var animationRef = null;

        window.addEventListener('load', init);

        var btnToggle = document.getElementById('btnToggle');
        btnToggle.addEventListener('click', function (evt) {
            if (evt.target.innerHTML == "Stop Animation") {
                evt.target.innerHTML = "Start Animation";
                evt.target.style.backgroundColor = "green";
                toggleAnim(false);
            } else {
                evt.target.innerHTML = "Stop Animation";
                evt.target.style.backgroundColor = "red";
                toggleAnim(true);

            }
        });

        function init() {
            canvas = document.getElementById('canvas1');
            context = canvas.getContext('2d');

            blank(context);

            animationRef = requestAnimationFrame(anim);
        }

        function blank(theContext) {
            theContext.fillStyle = "#00ddee";
            theContext.fillRect(0, 0, theContext.canvas.width, theContext.canvas.height);
        }

        function anim() {
            //while the object is still within the canvas move it by small amount
            if (rectDir > 0 && (rectX + rectW) < context.canvas.width) {
                if ((rectX + rectW + rectDir) >= context.canvas.width) {
                    rectDir = -rectDir;
                } else {
                    rectX += rectDir;
                }

            } else if (rectDir < 0 && rectX >= 0) {
                // object reached at left of canvas border
                // object will start moving backwards
                rectX += rectDir;
                if (rectX < 0) {
                    rectDir = -rectDir;
                }
            }


            //start with clean slate everytime
            blank(context);
            context.fillStyle = "yellow";
            context.strokeStyle = "red";
            context.lineWidth = 3;
            context.fillRect(rectX, rectY, rectW, rectW);
            context.strokeRect(rectX, rectY, rectW, rectW);


            animationRef = requestAnimationFrame(anim);
        }

        function toggleAnim(start) {
            if (start) {
                animationRef = requestAnimationFrame(anim);
            }
            else {
                cancelAnimationFrame(animationRef);
            }
        }

    </script>
</body>

</html>