<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LocalForage API</title>

    <script src="localforage.min.js"></script>

    <style>
        .form-field {
            display: inline-block;
        }

        button {
            background: none;
            border: 1px solid #ccc;
            padding: 5px;
            border-radius: 5px;
            cursor: pointer;
        }

        #setBtn {
            color: #fff;
            background-color: green;
        }

        #getBtn {
            color: #fff;
            background-color: orange;
        }

        #removeBtn {
            color: #fff;
            background-color: red;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>LocalForage</h1>
        <p>Below is the demonstration of what localforage api can do</p>



        <div class="form-field">
            <label for="key">key: <input type="text" id="key"></label>
        </div>
        <div class="form-field">
            <label for="value">value: <input type="text" id="value"></label>
        </div>
        <div class="form-field">
            <button id="setBtn">SET Value</button>
        </div>
        <div class="form-field">
            <button id="getBtn">GET Value</button>
        </div>
        <div class="form-field">
            <button id="removeBtn">REMOVE Value</button>
        </div>
        <div id="result">
            <p>Result: <strong></strong></p>
        </div>

        <hr>
        <h1>Support for Multiple instances</h1>
        <p>Multiple instances of localforage can be created to store data in multiple databases.</p>
        <em>Try following options and check console for logs.</em>
        <br>
        <div class="form-field"><button id="createBtn">Create Instances</button></div>
        <div class="form-field"><button id="storeBtn">Store Data</button></div>
        <div class="form-field"><button id="getDataBtn">Get Data</button></div>


    </div>


    <script>
        window.addEventListener('load', init);


        function init() {
            //grab key and value fields from DOM
            var keyElement = document.getElementById('key');
            var valueElement = document.getElementById('value');
            var resultElement = document.querySelector('#result strong');

            //grab all the buttons from DOM
            var setBtn = document.getElementById('setBtn');
            var getBtn = document.getElementById('getBtn');
            var removeBtn = document.getElementById('removeBtn');


            //store value against key using localforage
            setBtn.addEventListener('click', function () {
                //grab actual text from key value
                var key = keyElement.value;
                var val = valueElement.value;


                localforage.setItem(key, val).then(function (data) {
                    var result = "Successfully set, " + data;
                    console.log(result);
                    resultElement.innerHTML = result;
                });
            });


            //get value against key from indexDB using localforage
            getBtn.addEventListener('click', function () {
                var key = keyElement.value;

                localforage.getItem(key).then(function (returnedValue) {
                    console.log("Data: ", [key, returnedValue]);

                    resultElement.innerHTML = returnedValue ? returnedValue : "Doesn't Exist!!!";

                }).catch(function (error) {
                    console.warn("ERROR:", error);
                })
            });


            //remove value against a key
            removeBtn.addEventListener('click', function () {
                var key = keyElement.value;

                localforage.removeItem(key).then(function (data) {
                    console.log("Removed " + key + " successfully!", data);
                });
            });



            //HERE MULTIINSTANCE OF LOCALFORAGE CODE GOES...


            var createBtn = document.getElementById('createBtn');
            var storeBtn = document.getElementById('storeBtn');
            var getDataBtn = document.getElementById('getDataBtn');

            var instance1, instance2;
            const key = 'email';


            //create multiple instances of localforage (which create multiple databases)
            createBtn.addEventListener('click', function () {
                instance1 = localforage.createInstance({
                    'name': 'instance1'
                });

                instance2 = localforage.createInstance({
                    'name': 'instance2'
                });


                console.log("Instance1 and Instance2 is created!!!")
            });


            //store different value in those instances with same key
            storeBtn.addEventListener('click', function () {
                var value1 = 'bilalsaeed232@gmail.com';
                var value2 = 'bilalsaeed@hotmail.com';


                instance1.setItem(key, value1).then(function (result) {
                    console.log("Value1 is stored in instance1:", result);
                });

                instance2.setItem(key, value2).then(function (result) {
                    console.log("Value2 is stored in instance2:", result);
                });
            });


            //get all the data from all the instances
            getDataBtn.addEventListener('click', function () {
                instance1.getItem(key).then(function (val) {
                    console.log("instance1 data:", val);
                });

                instance2.getItem(key).then(function (val) {
                    console.log("instance2 data:", val);
                });
            });







        }


    </script>



</body>

</html>